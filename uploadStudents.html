<html>
<head>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.13/css/jquery.dataTables.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script type="text/javascript" charset="utf8" src="//cdn.datatables.net/1.10.13/js/jquery.dataTables.js"></script>
  

  <script>$('.dropdown-toggle').dropdown();


$('#divNewNotifications li').on('click', function() {
    $('#dropdown_title').html($(this).find('a').html());
    });</script>
  <style>
  	.dropbtn {
    background-color: #4CAF50;
    color: white;
    padding: 16px;
    font-size: 16px;
    border: none;
    cursor: pointer;
}

.dropdown {
    position: relative;
    display: inline-block;
}

.dropdown-content {
    display: none;
    position: absolute;
    background-color: #f9f9f9;
    min-width: 160px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 1;
}


table, th, td {
    border: 1px solid black;
    padding: 10px;
}


table {
    border-spacing: 25px;
}

.dropdown-content a {
    color: black;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
}

.dropdown-content a:hover {background-color: #f1f1f1}

.dropdown:hover .dropdown-content {
    display: block;
}

.dropdown:hover .dropbtn {
    background-color: #3e8e41;
}
  </style>
</head>
<body>
	<div class = "container-fluid">		
		<div class="col-md-12">
			<h2>Exam Details</h2>
			<table id="examDetails" class="table-bordered">
				<tr>
					<td>Exam ID: </td>
					<td><select id="ExistingTests"></select></td>
				</tr>
				<tr>
					<td>Question Paper: </td>
					<td id="qpaper"></td>
				</tr>
				<tr>
					<td>Date of Examination:</td>
					<td id="doe"></td>
				</tr>
			</table><br>
			<a href="" class="btn btn-primary btn-md" style = "float:left" type="button"> Host Test </a>
		</div>
		<div class="col-md-12">
			<br><h2> Upload Students </h2>		
		</div>

        <!-- {% for s in currentAdminTests %}
				print {{s}}
			{% endfor %} -->
		<div class="col-md-5">
			<h3> Add One Student </h3><hr>
			<form id="addStudent" action="/admin/addStudent" method="post">
			  <input id="dupexamid" type="hidden" name="examid">
			  <!-- <div class="input-group">
			    <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
			    <input id="rollnum" type="text" class="form-control" name="rollnum" placeholder="Roll. No.">
			  </div>
			  <div class="input-group">
			    <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
			    <input id="stuname" type="text" class="form-control" name="name" placeholder="Name">
			  </div> -->
			  <div class="input-group">
			    <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
			    <input id="email" type="text" class="form-control" name="email" placeholder="Email">
			  </div>
			  <!-- <div class="input-group">
			    <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
			    <input id="campus" type="text" class="form-control" name="learningcenter" placeholder="Learning Center">
			  </div> -->
			  <!-- <div class="input-group">
			    <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
			    <input id="year" type="text" class="form-control" name="Year" placeholder="Student Batch">
			  </div>
			  <div class="input-group">
			    <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
			    <input id="Section" type="text" class="form-control" name="Section" placeholder="Student Section">
			  </div> -->
			  <hr>
			  <button type="submit" id="button3" class="btn btn-success">Submit</button>
			</form>
			<span style="color:green">{{status}}</span>
		</div>
		<div class="col-md-7">
			<h3>Add Multiple Students</h3>
			<hr>
			<div class="row search">
				<!-- <h3> Search Students By </h3> -->

			   <!--  <select class="col-md-4 selectpicker" data-style="btn-success">
			      <option>Choose campus</option>
				  <option>Nuzvid</option>
				  <option>RKValley</option>
				  <option>Basara</option>
				</select>  -->
					
				  <!-- </div> -->
				<!-- </div> -->
				<div class=" col-md-4 dropdown">
				 <!--  <button class="dropbtn"> Choose Batch </button> -->
				  <select class="selectpicker" data-live-search="true" id = "button1" data-style="btn-success">
				  	  <option>Choose Batch</option>
					  <option> PUC 1 </option>
					  <option> PUC 2 </option>
					  <option> ENGG 1 </option>
					  <option> ENGG 2 </option>
					  <option> ENGG 3 </option>
					  <option> ENGG 4 </option>
				   </select>
				</div>
				<div class="col-md-4 dropdown">

				  <select class="selectpicker" data-style="btn-success" id = "button2" data-live-search="true">
				  	  <option> Choose Section </option>
					  <option> kappa 1 </option>
					  <option> kappa 2 </option>
					  <option> kappa 3 </option>
					  <option> kappa 4 </option>
					  <option> kappa 5 </option>
					  <option> kappa 6 </option>
				   </select>

				</div>
			</div>
			<br>
			<div style="padding: 2%" class="row">
				<table id="usertable" class="col-md-12 display">
					  <thead>
					  	<tr>
					    	<th>Roll No.</th>
					    	<th>Name</th>
					    	<th>Email</th>
					    	<th>Learning Center</th>
					  	</tr>
					  </thead>
				</table>
			</div>
			<br>
			<h4 class="text-center"><b>(OR)</b></h4>
			<br>
			<div class="form-group">
				<form method = "POST" name = "excel-form" action = "{{url}}" enctype="multipart/form-data">
				    <input type="file" id="studentscsv" name="csvfile">
				    <p class="help-block">(Please upload a students list in .csv format.)</p>
				</form>
			</div><hr>

			<button type = "submit" class="btn btn-md btn-success" id = "add_student">Add</button>
			
			<h3><FONT color = "green" > {{SuccessMsg}} </FONT></h3>
		</div>
	</div>
</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/js/bootstrap-select.min.js">
</script>
<script>
	
	function getData(examid){
		$.get( "/admin/getexamdetails?examid="+examid, function( data ) {
		  data = JSON.parse(data);
		  $("#qpaper").html(data[0]);
		  $("#doe").html(data[1]);
		});
	}
	var currentTests = {{ currentAdminTests|safe }}
	var options = "";

	for (var i = 0; i < currentTests.length; i++) {	
	 	options += "<option>"+currentTests[i]+"</option>";
	}
	$("#ExistingTests").append(options);
	
	getData($("#ExistingTests").val())

	$("#ExistingTests").on('change', function(){
		$("#dupexamid").val($("#ExistingTests").val());
		$("#qpaper").html("");
		$("#doe").html("");
		getData(this.value);
	});

	$(document).ready(function() {
	    $('#usertable').DataTable( {
	        "processing": true,
	        "serverSide": true,
	        "ajax": {
	            "url": "/admin/getstudents",
	            "type": "GET"
	        },
	        "columns": [
	            { "data": "rollno" },
	            { "data": "name" },
	            { "data": "email" },
	            { "data": "learningcenter" }
	        ]
	    });
	});
</script>

<script>
		// document.getElementById("button3").onclick = function () {
		// 	// var student = {}
		// 	// student["studentname"]  = $("#stuname").val();
		// 	// student["studentcampus"] = $("#campus").val();
		// 	// student["studentrollnum"] = $("#rollnum").val();
		// 	// student["studentmail"] = $("#mail").val();
		// 	// student["studentyear"] = $("#year").val();
		// 	// student["studentsection"] = $("#Section").val();
		// 	// // alert(student);
		// 	// console.log(student)
		// 	// $.post("/admin/addStudent",student).done(function(data){
		// 	// 	console.log(data)
		// 	// })
		// }
		// var examid = $("#Section").val();

		// if (studentname != "" & studentcampus != "" & studentrollnum !="" & studentmail != "" & studentyear != "" & studentsection !="") {
		// 	$.post( "/admin/check", { "studentname": studentname, "studentcampus": studentcampus, "studentrollnum": studentrollnum, "studentmail": studentmail,"studentyear": studentyear,"studentsection": studentsection})
		// 		.done(function( data ) {
		// 		    console.log(data);
		// 	 	});
		// 		}
		// 		else {
		// 			alert("Please fill out all the fields.")
		// 		}
		// 	};
</script>

		



<!-- <script>
		function addStudent() {
			var e = document.getElementById("ExistingTests");
			var value = e.options[e.selectedIndex].value;
			if(value==None) {
				alert(value)
				document.getElementById("button1").disabled = true;
				document.getElementById("button2").disabled = true;
				document.getElementById("button3").disabled = true;
				document.getElementById("button4").disabled = true;

			}
		}

</script> -->
<script type="text/javascript">
	$("#button3").click(function(event){
		console.log("btn clicked")
		event.preventDefault()
		$("#addStudent").submit();
	});
</script>


<script type="text/javascript">
		$("#add_student").click(function(){
			test = {}
			test["examid"] = $("#examid").val();
			test["date"] = $("#datetimepicker").val();
			test["questionset"] = $("#questionset").val();
			// var fd = new FormData($('#studentcsv').get(0));
			// console.log(fd);
			test["csv"] = $("#studentscsv")[0].files[0].name;
			test = JSON.stringify(test);
			$("#message").text(test+"");
			$('#passwordsNoMatchRegister').slideDown();
		});
		$("#dismiss").click(function(){
			$('#passwordsNoMatchRegister').hide();
		})
	</script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/css/bootstrap-select.min.css">
</html>
